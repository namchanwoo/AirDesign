# 반그리드 시스템 상세 기획서 (Half-Grid System)

> **문서 버전**: v1.1
> **작성일**: 2026-01-10
> **상태**: 수정 중
> **관련 문서**: 코어루프_기획서_초안.md (v0.4), 턴_시스템_상세기획서.md, 인텐트_시스템_상세기획서.md

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| **v1.0** | 2026-01-10 | 초안 작성 - 반그리드 시스템 상세 정의 |
| **v1.1** | 2026-01-10 | 진영 배치 수정 (왼쪽=아군, 오른쪽=적), 그리드 크기 조정 (3×3~4×4 기본) |

---

## 0. 기획 의도

> **핵심 경험**: "내 영역을 지키며, 적을 읽고 대응하는 전선 지휘관"

### 0.1 반그리드 시스템 설계 철학

**왜 "진영 분리" 구조인가?**

| 기존 시스템 | 문제점 | 본 시스템의 해결책 |
|------------|--------|-------------------|
| 단일 통합 그리드 | 아군/적군 위치 혼재 → 인지 부담 | 진영 분리 → "내 영역 / 적 영역" 명확 |
| 자유로운 이동 | 조작 스트레스, 실시간 부담 | 제한적 이동 → 전략적 선택으로 전환 |
| 단순 배치 개념 | 포지셔닝 = 장식 | 행/열 = 전선/깊이 → 위치가 전략 |

### 0.2 "반그리드(Half-Grid)"의 의미

> **시점**: 탑뷰 2D, **좌우 배치**

```
전체 전장 (탑뷰 2D - 좌우 배치)
┌─────────────────┬─────────────────┐
│   아군 진영      │      적 진영     │
│  (완전 통제)    │   (읽기 전용)    │
│                 │                 │
│  배치 & 최적화  │   관찰 & 예측   │
│         ── 공격 방향 →            │
└─────────────────┴─────────────────┘
        ↑                  ↑
   내 절반             상대 절반
   (Half)              (Half)
```

- **Half-Grid** = 전장의 "절반"만 직접 통제
- 아군 진영 (왼쪽): 배치하고 최적화하는 영역
- 적 진영 (오른쪽): 관찰하고 예측하는 영역
- 서로 상대 진영으로 **절대 침범 불가**

### 0.3 캐릭터 스프라이트 방향

| 진영 | 위치 | 스프라이트 방향 | 시선 |
|------|------|:-------------:|------|
| **아군** | 왼쪽 | → (오른쪽 봄) | 적 진영 향함 |
| **적** | 오른쪽 | ← (왼쪽 봄) | 아군 진영 향함 |

### 0.4 핵심 재미 요소

| 재미 요소 | 설명 | 시스템 연결 |
|-----------|------|-------------|
| **전선 관리** | 여러 행(전선)을 동시에 전략적 운용 | 행 기반 타겟팅 |
| **깊이 활용** | 전방/후방 개념으로 역할 분담 | 열 기반 우선순위 |
| **예측 후 배치** | 적 인텐트 확인 → 최적 포지션 선택 | 진영 분리 |
| **제한된 자원으로서의 이동** | 이동 = 코스트 소모 = 트레이드오프 | 카드 기반 이동 |

### 0.5 코어 컨셉과의 연계

**"자동으로 싸우는 유닛들, 전략적으로 개입하는 플레이어"**

반그리드 시스템은 이 핵심 컨셉을 강화한다:

| 자동 전투 (50%) | 플레이어 개입 (50%) |
|----------------|-------------------|
| 유닛들이 자기 행의 적 자동 공격 | 어느 행에 배치할지 결정 |
| 인텐트에 따른 자동 행동 | 인텐트 전환으로 행동 패턴 변경 |
| 같은 행 최전방 적 타겟팅 | 이동 카드로 타겟 변경 |

---

## 1. 그리드 구조 및 진영 배치

### 1.1 기본 구조

전장은 **2개의 독립된 진영 그리드**로 구성된다.

```
┌───────────────────────┐   ┌───────────────────────┐
│    아군 진영 그리드    │ ↔ │      적 진영 그리드    │
│       (Ally)          │   │       (Enemy)         │
│                       │   │                       │
│  ★ 적 침범 불가       │   │  ★ 아군 침범 불가     │
│  ★ 완전 통제          │   │  ★ 읽기 전용          │
└───────────────────────┘   └───────────────────────┘
         ←── 아군 공격 방향 ──→
         ←── 적 공격 방향 ────
```

### 1.2 그리드 규격

| 규격 | 아군 진영 | 적 진영 | 총 전장 | 적합 상황 |
|------|----------|--------|--------|----------|
| **3×3** | 3열×3행 | 3열×3행 | 6열×3행 | 일반 전투, 튜토리얼, 초반 |
| **4×4** | 4열×4행 | 4열×4행 | 8열×4행 | 정예 전투, 보스 전투 |
| **5×5** | 5열×5행 | 5열×5행 | 10열×5행 | 특수 이벤트, 최종 보스 (예외) |

> **권장 기본값**: 3×3 ~ 4×4 (시스템이 단순한 현재 단계에서 큰 그리드는 허전해 보임)

### 1.3 행(Row)과 열(Column)의 역할

#### 1.3.1 행(Row) = 전선(Battle Line)

- 같은 행 = 같은 전선
- 양 진영의 행 번호는 **공유**됨
- 행1의 아군 ↔ 행1의 적이 서로 마주봄

```
전장 시각화 (4×4 기준)

[아군 진영]                    [적 진영]
열1   열2   열3   열4    →    열4   열3   열2   열1
┌────┬────┬────┬────┐      ┌────┬────┬────┬────┐
│ A1 │    │    │    │ 행1 ↔│    │    │    │ E1 │ 행1
├────┼────┼────┼────┤      ├────┼────┼────┼────┤
│    │ A2 │    │    │ 행2 ↔│    │    │ E2 │    │ 행2
├────┼────┼────┼────┤      ├────┼────┼────┼────┤
│ A3 │ A4 │    │    │ 행3 ↔│    │ E4 │    │ E3 │ 행3
├────┼────┼────┼────┤      ├────┼────┼────┼────┤
│    │    │    │    │ 행4 ↔│    │    │    │    │ 행4
└────┴────┴────┴────┘      └────┴────┴────┴────┘
(후방)    (전방)            (전방)    (후방)

행1: A1 vs E1 (1:1 대치)
행2: A2 vs E2 (1:1 대치)
행3: A3, A4 vs E3, E4 (2:2 대치)
행4: 빈 전선 (양측 모두 없음)
```

#### 1.3.2 열(Column) = 깊이(Depth)

**아군 진영 (왼쪽):**
- 열1 = 후방 (Back Line) - 적과 가장 먼 쪽
- 열2~3 = 중앙 (Mid Line)
- 열N = 전방 (Front Line) - 적과 가장 가까운 쪽

**적 진영 (오른쪽):**
- 열N = 후방 (Back Line)
- 열1 = 전방 (Front Line) - 아군과 가장 가까운 쪽

| 위치 | 특성 | 적합 역할 |
|------|------|----------|
| 전방(열N) | 적 공격 먼저 받음, 관통에 가장 먼저 맞음 | 탱커, 근접 딜러 |
| 중앙(열2~3) | 균형 잡힌 위치 | 만능 딜러, 서포터 |
| 후방(열1) | 보호받음, 관통에 마지막으로 맞음 | 힐러, 원거리 딜러 |

### 1.4 좌표계 정의

```
좌표 표기: (진영, 열, 행) 또는 간략히 (열, 행)

예시 (4×4 그리드):
- 아군 A1 위치: (Ally, 1, 1) = 아군 진영, 열1(후방), 행1
- 적 E3 위치: (Enemy, 1, 3) = 적 진영, 열1(전방), 행3

내부 구현 시:
- 아군 진영: 열 1~N (오른쪽 = 전방, 적과 가까움)
- 적 진영: 열 1~N (왼쪽 = 전방, 아군과 가까움)
```

---

## 2. 이동 시스템

### 2.1 핵심 원칙: 1칸 이동 제한

모든 유닛은 **한 번에 1칸만** 이동할 수 있다.

| 규칙 | 내용 |
|------|------|
| **이동 거리** | 1칸 |
| **이동 방향** | 상하좌우 4방향 (대각선 불가) |
| **이동 범위** | 자기 진영 내에서만 |
| **진영 침범** | **절대 불가** (상대 진영으로 이동 불가) |

### 2.2 이동 방향

```
기본 이동 방향 (4방향)

        ↑ (행-1)
        │
  (열-1)←─●─→(열+1)
        │
        ↓ (행+1)

※ 대각선 이동은 기본적으로 불가
※ 특수 카드/능력으로 대각선 이동 해금 가능
```

### 2.3 이동 타이밍 및 방식

> **확정안: 카드 기반 이동**

유닛은 기본적으로 **제자리 유지**. 이동은 **카드 사용**으로만 가능.

| 항목 | 규칙 |
|------|------|
| **기본 상태** | 제자리 유지 (인텐트 행동만 수행) |
| **이동 수단** | 이동 카드 사용 (코스트 소모) |
| **이동 시점** | 카드 발동 즉시 |
| **이동 후** | 다음 턴부터 새 위치에서 행동 |

**이동 카드 예시:**

| 카드명 | 코스트 | 효과 |
|--------|--------|------|
| **전진** | 1 | 아군 1명을 전방(열+1)으로 1칸 이동 |
| **후퇴** | 1 | 아군 1명을 후방(열-1)으로 1칸 이동 |
| **측면 이동** | 1 | 아군 1명을 상하(행±1)로 1칸 이동 |
| **위치 교환** | 2 | 아군 2명의 위치를 교환 |
| **돌진** | 2 | 아군 1명을 전방으로 1칸 이동 + 같은 행 적 2데미지 |

### 2.4 이동의 전략적 가치

**"이동할까 vs 행동할까" 트레이드오프**

| 상황 | 이동 가치 | 이동 안 하면 |
|------|----------|-------------|
| 빈 행 → 적 있는 행 | ★★★ 매우 높음 | 대기 행동만 실행 |
| 위험 행 → 안전 행 | ★★☆ 높음 | 집중 피격으로 체력 소진 |
| 후방 → 전방 | ★★☆ 높음 | 탱커 역할 못함 |
| 전방 → 후방 | ★☆☆ 중간 | 관통 공격에 먼저 맞음 |
| 큰 차이 없음 | ☆☆☆ 낮음 | 코스트 절약 |

### 2.5 이동 불가 상황

| 상황 | 설명 |
|------|------|
| 목표 칸에 유닛 있음 | 1타일 1캐릭터 원칙 |
| 그리드 밖으로 이동 | 범위 초과 |
| 상대 진영으로 이동 | 진영 침범 금지 |
| 스턴/속박 상태 | CC 상태이상 |
| 카드 사용 중 | 카드 효과 처리 완료 전 |

---

## 3. 공격 사거리/범위 시스템

### 3.1 기본 원칙: 행/열 기반 공격

- **행(Row)** = 타겟팅 방향 (어느 전선의 적을 공격하는가)
- **열(Column)** = 사거리/우선순위 (전선 내 어느 적을 먼저 맞추는가)

### 3.2 기본 타겟팅 규칙

> **핵심: 같은 행의 최전방 적**

```
아군 유닛이 공격할 때:

1. 같은 행(Row)에 있는 적 진영 유닛만 타겟 가능
2. 같은 행에 여러 적이 있으면 최전방(아군과 가까운) 적 우선
3. 같은 행에 적이 없으면 공격 불가 → 대기 행동

예시:
[아군 진영]              [적 진영]
열1   열2                열2   열1
┌────┬────┐          ┌────┬────┬────┐
│    │ A1 │ 행1 ──→  │ E2 │ E1 │    │ 행1
├────┼────┤          ├────┼────┼────┤
│ A2 │ A3 │ 행2 ──→  │ E3 │    │    │ 행2
├────┼────┤          ├────┼────┼────┤
│    │ A4 │ 행3 ──→  │    │    │    │ 행3
└────┴────┘          └────┴────┴────┘

A1의 타겟: E1 (행1, 최전방 - 아군과 가장 가까움)
A2, A3의 타겟: E3 (행2, 유일한 적)
A4: 타겟 없음 → 대기 행동 실행
```

### 3.3 공격 유형 분류

| 유형 | 행 범위 | 열 범위 | 설명 | 예시 |
|------|---------|---------|------|------|
| **단일 공격** | 같은 행 | 최전방 1명 | 기본 공격 | 기본 타격 |
| **관통 공격** | 같은 행 | 전방 2~3열 | 뒤까지 관통 | 창 찌르기 |
| **행 전체** | 같은 행 | 모든 열 | 같은 행 전체 | 화염 작렬 |
| **인접 행** | ±1행 | 최전방 | 상하 행 포함 | 광역 휩쓸기 |
| **십자 공격** | 같은 행 + ±1행 | 최전방 | + 모양 범위 | 충격파 |
| **전체 광역** | 모든 행 | 최전방 | 적 전체 | 궁극기 |

### 3.4 관통 공격 상세

관통 공격은 **열 순서대로** 여러 적에게 피해를 준다.

```
관통 깊이 2의 공격:

[아군 진영]        [적 진영]
열1                열3   열2   열1
┌────┐          ┌────┬────┬────┐
│ A1 │ 행1 ───→ │ E1 │ E2 │ E3 │
└────┘          └────┴────┴────┘

A1이 관통 2 공격 시:
1차 타겟: E3 (열1, 최전방 - 아군과 가장 가까움)
2차 타겟: E2 (열2, 관통)
E1은 맞지 않음 (관통 깊이 초과)
```

### 3.5 범위 공격 상세

```
인접 행 공격 (범위 ±1행):

[아군 진영]        [적 진영]
열1                열1
┌────┐          ┌────┐
│    │ 행1  ┌─→ │ E1 │
├────┤      │   ├────┤
│ A1 │ 행2 ─┼─→ │ E2 │  (A1 위치)
├────┤      │   ├────┤
│    │ 행3  └─→ │ E3 │
└────┘          └────┘

A1의 인접 행 공격:
- 행1의 E1 피격
- 행2의 E2 피격 (같은 행)
- 행3의 E3 피격
```

### 3.6 타겟팅 우선순위 규칙

> **확정됨**

동일 조건 내에서의 우선순위:

| 우선순위 | 기준 | 설명 |
|:--------:|------|------|
| 1순위 | **같은 행** | 행 번호 일치 |
| 2순위 | **최전방** | 아군과 가장 가까운 적 |
| 3순위 | **인텐트 지정** | 특정 조건 (HP 최저 등) |

### 3.7 공격 불가 상황과 대기 행동

```
공격 가능 여부 판정:

                    ┌─ 있음 → 실행 행동 (공격)
같은 행에 적 존재? ─┤
                    └─ 없음 → 대기 행동
```

**대기 행동의 전략적 활용:**

| 상황 | 활용 전략 |
|------|----------|
| 빈 행에 힐러 배치 | 코스트 충전 + 자힐 |
| 빈 행에 버퍼 배치 | 자버프 축적 |
| 의도적 빈 행 이동 | 안전하게 충전 후 복귀 |

---

## 4. 포지셔닝 전략

### 4.1 전선(행) 배치 전략

**전선별 역할 분담:**

```
예시 4×4 전장:

행1: [주력 전선] 아군 탱커+딜러 vs 적 딜러
행2: [보조 전선] 아군 딜러 vs 적 서포터
행3: [안전 지대] 아군 힐러 (충전) vs 적 없음
행4: [잠재 위협] 대응 필요 vs 적 암살자
```

**전선 관리 원칙:**

| 원칙 | 설명 |
|------|------|
| **집중 vs 분산** | 적 강한 행에 아군 집중 vs 여러 행에 분산 |
| **빈 전선 활용** | 적 없는 행 = 안전한 충전 기지 |
| **전선 이동** | 상황에 따라 행 변경으로 타겟 조절 |

### 4.2 깊이(열) 배치 전략

**열별 역할 분담:**

```
아군 진영 (3×3 기준):

열1 (후방): 힐러 배치 - 가장 안전
열2 (중앙): 딜러/서포터 배치 - 관통 2번째, 균형 위치
열3 (전방): 탱커 배치 - 적 공격 먼저 받음
```

**깊이 배치 효과:**

| 열 | 피격 순서 | 적합 역할 | 리스크 |
|---|:--------:|----------|--------|
| 전방(열N) | 1순위 | 탱커, 도발 | 집중 피격 |
| 중앙 | 2순위 | 근접 딜러, 서포터 | 관통에 노출 |
| 후방(열1) | 마지막 | 힐러, 원거리 | 전방 붕괴 시 위험 |

### 4.3 포지셔닝과 인텐트 연동

**위치에 따른 최적 인텐트:**

| 위치 | 추천 인텐트 유형 | 이유 |
|------|-----------------|------|
| 전방(열N) | 도발, 방어 | 적 공격 집중 시 생존 |
| 전방(열N) | 단일 강타 | 최전방 적 빠른 처치 |
| 후방(열1~2) | 광역, 지원 | 안전한 위치에서 딜/힐 |
| 빈 행 | 충전 특화 | 코스트 빠른 확보 |

### 4.4 진형(Formation) 예시

```
[공격 진형] - DPS 극대화 (3×3)
열1   열2   열3
(후방)(중앙)(전방)
┌────┬────┬────┐
│    │딜러│탱커│ 행1
├────┼────┼────┤
│힐러│딜러│딜러│ 행2
└────┴────┴────┘
특징: 전방에 화력 집중, 행1에서 적 집중 처리

[방어 진형] - 생존 극대화 (3×3)
열1   열2   열3
┌────┬────┬────┐
│힐러│    │탱커│ 행1
├────┼────┼────┤
│    │딜러│탱커│ 행2
└────┴────┴────┘
특징: 탱커 2명으로 전선 방어

[분산 진형] - 광역 대응 (3×3)
열1   열2   열3
┌────┬────┬────┐
│    │    │탱커│ 행1
├────┼────┼────┤
│    │딜러│    │ 행2
├────┼────┼────┤
│힐러│    │    │ 행3
└────┴────┴────┘
특징: 광역 공격에 1명만 피격
```

---

## 5. 대형 유닛 (보스/정예) 시스템

### 5.1 기본 원칙

| 유닛 유형 | 점유 크기 | 설명 |
|----------|----------|------|
| 일반 유닛 | 1×1 | 1타일 점유 |
| 정예 유닛 | 2×1 또는 1×2 | 2타일 점유 |
| 보스 유닛 | 2×2 | 4타일 점유 |

### 5.2 그리드별 대형 유닛 제한

| 그리드 | 허용 크기 | 제한 이유 |
|:------:|----------|----------|
| **3×3** | 2×1, 1×2 (최대) | 2×2 = 44% 점유 → 밸런스 붕괴 |
| **4×4** | 2×2 (보스) | 25% 점유 → 적정 |
| **5×5** | 3×2, 2×3 | 24% 이하 점유 → 가능 |

### 5.3 대형 유닛 점유 규칙

**코어 칸(Core Cell) 개념:**

- 대형 유닛은 **코어 칸**을 기준으로 점유
- 코어 칸 = 좌상단 (2×2) 또는 좌측 (2×1)
- 좌표 표기는 코어 칸 기준

```
정예몹 (2×1 가로형) - 3×3 그리드:

[적 진영]
열3   열2   열1
(후방)(중앙)(전방)
┌────┬────┬────┐
│    │████│████│ 행1  ← 정예: 열1~2 점유, 2개 행 공격 가능
├────┼────┼────┤        코어 칸: (열2, 행1)
│    │ E1 │    │ 행2
└────┴────┴────┘

보스몹 (2×2) - 4×4 그리드:

[적 진영]
열4   열3   열2   열1
(후방)          (전방)
┌────┬────┬────┬────┐
│    │    │    │    │ 행1
├────┼────┼────┼────┤
│    │████│████│    │ 행2  ← 보스: 행2~3, 열1~2 (2×2)
├────┼────┼────┼────┤        코어 칸: (열2, 행2)
│    │████│████│    │ 행3
├────┼────┼────┼────┤
│    │    │    │    │ 행4
└────┴────┴────┴────┘
```

### 5.4 대형 유닛 타겟팅

**행 판정:**
- 점유한 모든 행에 대해 타겟팅 가능
- 예: 2×2 보스가 행2~3 점유 → 행2 아군도, 행3 아군도 공격 가능

**열 판정:**
- 최전방 열 기준으로 피격 순서 판정
- 예: 열1~2 점유 → 열1이 최전방으로 간주

```
[상황] 아군이 행2, 행3에서 공격

[아군 진영]         [적 진영]
열1                 열3   열2   열1
┌────┐           ┌────┬────┬────┐
│    │ 행1       │    │    │    │ 행1
├────┤           ├────┼────┼────┤
│ A1 │ 행2 ───→  │    │████│████│ 행2  보스(2×2)
├────┤           ├────┼────┼────┤
│ A2 │ 행3 ───→  │ E1 │████│████│ 행3
└────┘           └────┴────┴────┘

A1의 타겟:
- 행2 최전방 적 = 보스 (열1, 행2 점유)
- A1의 타겟: 보스

A2의 타겟:
- 행3 최전방 적 = E1 (열3)? 보스 (열1)?
- 보스가 열1이므로 최전방 → A2의 타겟: 보스
- E1은 보스 뒤에 있으므로 보스 처치 후 타겟
```

### 5.5 대형 유닛 피격 판정

**광역 피격 규칙:**

> **확정안: 유닛당 1회만 피격**

| 공격 유형 | 판정 | 설명 |
|----------|------|------|
| 단일 공격 | 1회 피격 | 점유 크기 무관 |
| 행 전체 공격 | 1회 피격 | 여러 행 점유해도 1회 |
| 인접 행 공격 | 1회 피격 | 범위 내 여러 칸 있어도 1회 |

**설계 의도:**
- 대형 유닛이 광역에 불리하지 않도록
- 대형 = 높은 HP로 버티는 설계
- 점유 칸 수 = 위협 범위 (공격 가능 행), 방어력 아님

### 5.6 대형 유닛 밸런싱

| 크기 | HP 계수 | 공격 가능 행 | 권장 그리드 |
|------|:-------:|:-----------:|:-----------:|
| 1×1 | ×1.0 | 1행 | 모든 크기 |
| 2×1 | ×1.8 | 2행 | 3×3 이상 |
| 1×2 | ×1.5 | 1행 (깊이 2) | 3×3 이상 |
| 2×2 | ×3.0 | 2행 | **4×4만** |
| 3×2 | ×4.0 | 3행 | 5×5 권장 |

### 5.7 3×3용 "압축 보스" 개념

3×3에서 2×2 보스를 사용할 수 없으므로, 동일한 위협도를 가진 2×1 압축 보스 도입:

```
압축 보스 (2×1):

[적 진영]
열3   열2   열1
┌────┬────┬────┐
│    │    │    │ 행1
├────┼────┼────┤
│    │████│████│ 행2  ← 압축 보스 (2×1, 22% 점유)
├────┼────┼────┤
│    │    │    │ 행3
└────┴────┴────┘

특징:
- 물리적 점유: 2칸 (2×1)
- 위협 범위: 행1~3 공격 가능 (인접 행 공격 패턴)
- HP: 2×2 보스급 (HP 계수 ×2.5)
- 시각적 크기: 2칸에 걸쳐 크게 표현
```

---

## 6. 턴/인텐트 시스템과의 연동

### 6.1 반그리드에서의 실행 조건 확장

기존 인텐트 조건이 반그리드에 맞게 확장된다.

| 기존 조건 | 반그리드 해석 |
|----------|--------------|
| 같은 행에 적 존재 | 같은 행의 **적 진영**에 적 유닛 존재 |
| 같은 행에 아군 존재 | 같은 행의 **아군 진영**에 아군 유닛 존재 |

**새로운 조건 유형:**

| 조건 | 설명 | 예시 인텐트 |
|------|------|------------|
| **전방에 아군 존재** | 자신보다 높은 열에 아군 | 후방 지원형 |
| **후방에 아군 존재** | 자신보다 낮은 열에 아군 | 탱커 보호형 |
| **빈 행** | 같은 행에 적 없음 | 충전 특화형 |
| **인접 행 적 존재** | 상하 ±1행에 적 | 기동형 공격 |
| **적 N명 이상** | 같은 행에 적 다수 | 광역 특화형 |

### 6.2 위치 기반 인텐트 예시

```
[탱커 - 철벽 수호]
턴 주기: 2턴
실행 조건: 후방(자신보다 낮은 열)에 아군 존재
실행 행동: 후방 아군 받는 피해 -30% (2턴)
대기 행동: 자신에게 보호막 3

→ 전방(열N)에 배치해야 효과적
→ 혼자 있으면 대기 행동으로 자기 방어

[힐러 - 원격 치유]
턴 주기: 3턴
실행 조건: 같은 행에 적 없음 (빈 행)
실행 행동: 아군 전체 HP 3 회복
대기 행동: 자신 HP 2 회복

→ 의도적으로 빈 행에 배치하여 안전하게 힐
→ 적 있는 행으로 이동하면 조건 불충족
```

### 6.3 이동과 인텐트의 연계

이동으로 실행 조건 충족 여부를 조절할 수 있다.

```
[시나리오]
딜러: "집중 사격" (조건: 같은 행에 적 1명만)
현재 위치: 행2 (적 3명 존재) → 조건 불충족 → 대기 행동

이동 카드 사용 → 행3으로 이동 (적 1명 존재)
→ 조건 충족! → 실행 행동 (고데미지 단일 공격)
```

### 6.4 새로운 이동 관련 인텐트

> **[검토 필요]** 자동 이동 인텐트 도입 여부

| 인텐트 유형 | 실행 행동 | 대기 행동 |
|------------|----------|----------|
| **전진 의지** | 같은 행 적 공격 | 전방으로 1칸 이동 |
| **회피 본능** | 같은 행 적 공격 | 후방으로 1칸 이동 |
| **추적 본능** | 같은 행 적 공격 | 적 가장 많은 행으로 이동 |

**주의:** 자동 이동 인텐트는 플레이어 통제력을 낮출 수 있음. 신중한 도입 필요.

---

## 7. 새로운 메커니즘 (확장 가능성)

### 7.1 전선 상태 시스템

> **[추후 검토]** 프로토타입 테스트 후 도입 여부 결정

**전선 붕괴:**
- 조건: 행에 아군 전멸 또는 일정 피해 누적
- 효과: 해당 행 아군 재배치 시 1턴 스턴, 받는 피해 +20%

**전선 강화:**
- 조건: 행에서 적 전멸
- 효과: 해당 행 아군 공격력 +10% (전투 종료까지)

### 7.2 교차 사격 (Cross Fire)

> **[추후 검토]** 협동 공격 보너스

인접 행의 아군이 같은 적을 공격 시 보너스:

```
행1 아군 A → 적 E 공격
행2 아군 B → 적 E 공격 (같은 적, 대형 유닛 등)

→ "교차 사격" 발동: 추가 피해 15%
```

### 7.3 영역 효과 (Zone Effect)

> **[추후 검토]** 지형 효과 카드

특정 칸에 지속 효과 설치:

| 효과 | 설명 |
|------|------|
| 화염 지대 | 해당 칸의 적 공격 시 반격 데미지 |
| 치유 지대 | 해당 칸의 아군 매턴 HP 회복 |
| 둔화 지대 | 해당 칸 진입 시 이동 불가 1턴 |

---

## 8. 밸런스 가이드라인

### 8.1 그리드 크기별 밸런싱

| 그리드 | 아군 수 | 적 수 | 밀도 | 전략 깊이 | 비고 |
|--------|:------:|:----:|:----:|:--------:|------|
| **3×3** | 3~4명 | 4~5명 | 44~50% | 낮음 | 기본, 일반 전투 |
| **4×4** | 4명 | 6~8명 | 31~38% | 중간 | 정예/보스 전투 |
| 5×5 | 4명 | 8~12명 | 24~32% | 높음 | 특수 이벤트만 |

**밀도 공식:**
```
밀도 = (아군 수 + 적 수) / (그리드 칸 수 × 2)

권장 밀도:
- 40~55%: 균형잡힌 전투 (3×3 최적)
- 30~40%: 이동 전략 중요 (4×4)
```

### 8.2 이동 카드 밸런싱

| 카드 유형 | 코스트 | 효과 |
|----------|:------:|------|
| 기본 이동 | 1 | 1칸 이동 (상하좌우 중 1방향) |
| 위치 교환 | 2 | 아군 2명 교환 |
| 이동 + 효과 | 2~3 | 1칸 이동 + 추가 효과 |
| 대각선 이동 | 2 | 대각선 1칸 이동 |
| 장거리 이동 | 3 | 2칸 이동 |

### 8.3 빈 행 전략 밸런싱

**문제:** 빈 행에만 배치 → 대기 행동으로 무한 충전?

**해결책:**
1. 적 인텐트에 "전체 공격" 또는 "행 변경 공격" 추가
2. 연속 대기 페널티: 3턴 연속 대기 시 "전의 상실" 디버프 (공격력/방어력 -20%)
3. 적 추적 AI: 빈 행에만 있으면 적이 행 이동하여 추격
4. 코스트 상한선 설정 (8~10)
5. 전투 턴 제한 (30턴 초과 시 패배)

### 8.4 대형 유닛 밸런싱

**설계 원칙:**
- 점유 크기 ↑ = HP ↑ (비례)
- 점유 크기 ↑ = 위협 범위 ↑ (공격 가능 행 증가)
- 점유 크기 ↑ ≠ 방어력 ↑ (광역에 1회만 피격)

---

## 9. UI/UX 고려사항

### 9.1 그리드 시각화 (탑뷰 2D - 좌우 배치)

```
┌──────────────────────────────────────────────────────────┐
│                    전투 화면 레이아웃                      │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  [아군 진영 그리드]            [적 진영 그리드]           │
│                                                          │
│  ┌───┬───┬───┬───┐      ┌───┬───┬───┬───┐             │
│  │   │   │ A1│   │  →   │   │ E1│   │   │             │
│  │   │   │⚔️│   │      │   │⚔️│   │   │             │
│  │   │   │[3]│   │      │   │[2]│   │   │             │
│  ├───┼───┼───┼───┤      ├───┼───┼───┼───┤             │
│  │   │ A2│ A3│   │  →   │   │ E3│   │ E2│             │
│  │   │💚│🔮│   │      │   │🛡️│   │💀│             │
│  │   │[2]│[4]│   │      │   │[3]│   │[1]│             │
│  └───┴───┴───┴───┘      └───┴───┴───┴───┘             │
│                                                          │
│  열1  열2  열3  열4      열4  열3  열2  열1               │
│  (후방)    (전방)      (전방)    (후방)                 │
│                                                          │
│  ─────────────────────────────────────────────────────  │
│                 [하단 UI: 카드, 인텐트, 정보]             │
└──────────────────────────────────────────────────────────┘
```

### 9.2 행/열 표시

- **행 번호**: 양쪽 그리드 사이에 공유 표시 (L1, L2, L3...)
- **열 번호**: 각 진영 하단에 개별 표시
- **전방/후방 라벨**: 열 번호 아래에 표시

### 9.3 타겟팅 표시

```
공격 가능 표시:

아군 유닛 선택 시:
- 같은 행의 적에게 화살표 표시
- 최전방 적 = 실선 화살표 (주 타겟)
- 후방 적 = 점선 화살표 (관통 시 타겟)

[아군]              [적]
  A1  ══════════→   E1 (주 타겟)
      - - - - - →   E2 (관통 타겟)
```

### 9.4 이동 가능 표시

```
이동 카드 선택 시:

현재 위치: ●
이동 가능: ○

  ○
○ ● ○
  ○

※ 점유된 칸, 진영 외부는 이동 불가 표시 (X)
```

---

## 10. 검토 필요 사항

| 항목 | 현재 상태 | 검토 내용 |
|------|----------|----------|
| **대각선 이동** | 기본 불가 | 카드로 해금 vs 기본 허용 |
| **자동 이동 인텐트** | 미정 | 플레이어 통제력 vs 자동화 |
| **전선 상태 시스템** | 추후 검토 | 복잡도 vs 전략 깊이 |
| **광역 피격 규칙** | 유닛당 1회 | 플레이테스트 후 조정 |
| **그리드 기본 크기** | 3×3~4×4 | 스테이지별 차등 적용 |
| **이동 카드 코스트** | 1~3 | 밸런스 테스트 필요 |
| **빈 행 악용 방지** | 일부 해결책 | 연속 대기 페널티 등 추가 검토 |

---

## 11. 추가 검토 필요 항목 (P0)

> v1.1에서 식별된 미정의 사항

### 11.1 초기 배치 시스템

| 항목 | 검토 필요 내용 |
|------|---------------|
| 배치 방식 | 드래그앤드롭? 슬롯 선택? 프리셋? |
| 배치 가능 영역 | 아군 진영 전체? 일부 열만? |
| 적 정보 공개 | 배치 전 적 위치/인텐트 공개 범위 |
| 시간 제한 | 배치 제한 시간 유무 |

### 11.2 리타겟팅 규칙

| 상황 | 처리 방법 필요 |
|------|---------------|
| 공격 중 타겟 사망 | 다음 타겟으로 자동? 공격 취소? |
| 관통 공격 중 사망 | 다음 열 타겟으로 계속? |
| 타겟 이동 | 추적? 원래 위치 공격? |

### 11.3 동시 행동 처리

| 질문 | 정의 필요 |
|------|----------|
| 같은 턴에 서로 공격 | 속도 개념? 선공/후공? |
| 양쪽 사망 시 | 무승부 처리? |
| 처리 순서 | 아군 먼저? 적 먼저? 동시? |

> 참조: 턴_시스템_상세기획서.md의 스피드 스탯 규칙

### 11.4 전투 종료 조건

| 조건 | 정의 필요 |
|------|----------|
| 승리 | 적 전멸? 보스 처치? |
| 패배 | 아군 전멸? 특정 유닛 사망? |
| 턴 제한 | 초과 시 패배? 강제 종료? |

---

## 부록 A: 용어 정리

| 용어 | 정의 |
|------|------|
| **반그리드 (Half-Grid)** | 전장의 절반만 직접 통제하는 진영 분리 시스템 |
| **진영 (Side)** | 아군/적군이 점유하는 독립된 그리드 영역 |
| **행 (Row) / 라인 (Line)** | 그리드의 가로줄, 전선(Battle Line) 개념 |
| **열 (Column) / 랭크 (Rank)** | 그리드의 세로줄, 깊이(Depth) 개념 |
| **전방 (Front)** | 상대 진영과 가장 가까운 열 |
| **후방 (Back)** | 상대 진영과 가장 먼 열 |
| **코어 칸 (Core Cell)** | 대형 유닛의 기준 좌표 |
| **전선 (Battle Line)** | 같은 행으로 연결된 양 진영의 대치선 |
| **관통 (Pierce)** | 여러 열의 적을 순서대로 공격하는 효과 |

---

## 부록 B: 데이터 테이블 스키마 (참고)

### B.1 그리드 설정 테이블

```
DT_GridSettings
├── DefaultGridSize (FIntPoint) = (3, 3)   // 기본 3×3
├── EliteGridSize (FIntPoint) = (4, 4)     // 정예/보스 4×4
├── MaxSize (FIntPoint) = (5, 5)           // 특수 이벤트만
├── AllowDiagonalMove (bool) = false
├── MaxUnitsPerSide (int32) = 4
└── DensityRange (FFloatRange) = (0.4, 0.55)
```

### B.2 위치 데이터 구조

```
FGridPosition
├── Side (EGridSide: Ally / Enemy)
├── Column (int32) = 1~N
├── Row (int32) = 1~N
└── IsOccupied (bool)

FLargeUnitOccupancy
├── CorePosition (FGridPosition)
├── OccupiedCells (TArray<FGridPosition>)
├── Size (FIntPoint) = (Width, Height)
└── OccupiedRows (TArray<int32>)
```

### B.3 공격 범위 정의

```
FAttackRange
├── RangeType (EAttackRangeType)
│   ├── SameRow (같은 행)
│   ├── AdjacentRow (인접 행)
│   ├── CrossRow (십자)
│   └── AllRows (전체)
├── PierceDepth (int32) = 1~N (관통 깊이)
├── TargetPriority (ETargetPriority)
│   ├── FrontMost (최전방)
│   ├── LowestHP (HP 최저)
│   └── Specific (지정)
└── MaxTargets (int32) = 1~N
```

---

## 부록 C: 레퍼런스 분석

### C.1 유사 시스템 게임

| 게임 | 그리드 | 이동 | 진영 분리 | 참고점 |
|------|--------|------|:--------:|--------|
| **Mega Man BN** | 3×6 | 자유 | ○ | 진영 분리 원조, 패널 점유 |
| **One Step From Eden** | 4×8 | 자유 | △ | 실시간 + 카드, 빠른 템포 |
| **Into the Breach** | 8×8 | 자유 | × | 예측 + 포지셔닝, 퍼즐적 |
| **Alina of the Arena** | 가변 | 제한 | × | 그리드 전략, 적 인텐트 |
| **Darkest Dungeon** | 1×4 | 순서 | × | 행(라인업) 포지셔닝 |

### C.2 AIR 반그리드의 차별점

1. **진영 분리 + 인텐트 시스템**: 자동 행동과 진영 통제의 결합
2. **카드 기반 제한적 이동**: 이동 = 전략적 자원
3. **행/열 분리 역할**: 전선(행) + 깊이(열) 이중 전략
4. **자동 전투 50%**: 관전 후 개입 리듬
5. **소형 그리드 (3×3~4×4)**: 밀도 높은 전투, 빈틈 없는 경험

---

*문서 끝*