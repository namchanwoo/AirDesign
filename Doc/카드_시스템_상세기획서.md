# 카드 시스템 상세기획서

> **버전**: v2.1
> **최종 수정**: 2026-01-11
> **관련 문서**: [턴 시스템](턴_시스템_상세기획서.md), [인텐트 시스템](인텐트_시스템_상세기획서.md), [코어루프](코어루프_기획서_초안.md)

---

## 1. 개요

카드 시스템은 플레이어가 전투 중 유닛의 행동을 직접 제어하는 핵심 시스템입니다.

### 1.1 핵심 설계 철학

**"캐릭터 네러티브에서 유래하지만, 전략적 선택은 플레이어에게"**

- 카드는 캐릭터의 스토리와 정체성에서 유래
- 하지만 **어떤 캐릭터든 어떤 카드든 사용 가능**
- 카드 배치와 운용은 **전략 지휘관(플레이어)**의 판단

### 1.2 핵심 재미 요소

| 요소 | 설명 |
|------|------|
| **준비와 타이밍** | 카드 배치 후 적절한 타이밍에 발동 |
| **전략적 덱빌딩** | 덱 구성과 카드 조합 최적화 |
| **범용적 카드 운용** | 상황에 따라 다른 캐릭터에게 같은 카드 배치 |
| **예측과 대응** | 적 행동 예측 및 리액션 카드로 대응 |

---

## 2. 덱 구조

### 2.1 파티 공유 단일 덱

**핵심 원칙**: 파티 전체가 **하나의 덱**을 공유

```
┌─────────────────────────────────────────────┐
│              [파티 공유 덱]                   │
│                                             │
│   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐          │
│   │카드1│ │카드2│ │카드3│ │...  │          │
│   └─────┘ └─────┘ └─────┘ └─────┘          │
│                                             │
│   모든 파티원이 공유하여 사용                 │
└─────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────┐
│              [파티 핸드]                     │
│                                             │
│   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ │
│   │     │ │     │ │     │ │     │ │     │ │
│   └─────┘ └─────┘ └─────┘ └─────┘ └─────┘ │
│                                             │
│   최대 5장 / 어떤 캐릭터에든 배치 가능        │
└─────────────────────────────────────────────┘
```

### 2.2 덱 크기

| 항목 | 값 |
|------|-----|
| **최소** | 제한 없음 (플레이어 전략적 선택) |
| **최대** | 40장 |

**전략적 고려사항**:
- **작은 덱**: 원하는 카드를 빠르게 드로우, 일관된 전략
- **큰 덱**: 다양한 상황 대응, 기회비용 낮음, 변수 대응력

### 2.3 중복 카드

- **허용**: 같은 카드를 여러 장 보유 가능
- 중복 장수 제한은 추후 밸런싱으로 결정

---

## 3. 드로우 시스템

### 3.1 드로우 타이밍

**매 턴 1장씩 드로우** (테스트 후 2~3장으로 조정 가능)

```
턴 0 (전투 시작)
  │
  ▼ (3초 경과)
턴 1: 1장 드로우 → 핸드 1장
  │
  ▼ (3초 경과)
턴 2: 1장 드로우 → 핸드 2장
  │
  ▼ (3초 경과)
턴 3: 1장 드로우 → 핸드 3장
  │
  ...
  │
  ▼
턴 5: 1장 드로우 → 핸드 5장 (최대)
```

### 3.2 핸드 제한

| 항목 | 값 |
|------|-----|
| **최대 핸드** | 5장 |
| **초과 시** | 드로우 불가 (이번 턴 드로우 스킵) |

### 3.3 카드 버리기 시스템

**핵심**: 카드는 **자동으로 버려지지 않음**. 플레이어가 **수동으로 버리기 예약**

#### 버리기 예약 흐름

```
[현재 턴]
플레이어가 핸드의 카드에 "버리기 예약" 표시
         │
         ▼
[다음 턴 시작 시]
버리기 예약된 카드 → 묘지로 이동
         │
         ▼
[드로우 단계]
덱에서 카드 드로우 (핸드 5장 미만일 때만)
```

#### UI 동작
- 핸드의 각 카드에 두 가지 선택지:
  1. **캐릭터 슬롯에 배치** (드래그 또는 클릭)
  2. **버리기 예약** (휴지통 아이콘 또는 특정 영역으로 드래그)
- 버리기 예약된 카드는 시각적으로 구분 (반투명, X 표시 등)

### 3.4 턴별 카드 흐름

```
[턴 증가 (3초 경과)]
         │
         ▼
[1단계] 버리기 예약 카드 처리
         │ 예약된 카드 → 묘지로 이동
         ▼
[2단계] 카드 드로우
         │ 핸드 5장 미만이면 1장 드로우
         │ 덱이 비었으면: 묘지 셔플 → 새 덱 구성 → 드로우
         ▼
[3단계] 인텐트 실행
         │ 턴 카운터 0인 유닛 행동
         ▼
[턴 진행 중 (0~3초)]
         │ 카드 배치/발동/버리기예약 가능
         ▼
[다음 턴 증가...]
```

### 3.5 덱 소진 시 처리

1. 드로우 시점에 덱이 비어있으면
2. **묘지(버린 카드 더미)**를 셔플하여 새 덱 구성
3. 새 덱에서 카드 드로우
4. 진행 계속

---

## 4. 카드 메커니즘

### 4.1 액션 카드 (Action)

**정의**: 플레이어가 직접 발동 타이밍을 결정하는 능동적 카드

| 항목 | 설명 |
|------|------|
| **배치** | 핸드에서 캐릭터의 카드 슬롯에 배치 |
| **발동 조건** | 스페이스바 2회 연타 |
| **발동 범위** | 아군 진영의 모든 배치된 액션 카드 동시 발동 |
| **발동 순서** | 단일 카드: 즉시 발동 / 2장 이상: 카드 Queue 위젯으로 순서 지정 |

**발동 타이밍 제한**:
- 턴 진행 중(0~3초 사이) 언제든 발동 가능
- **턴 전환 시점**(인텐트 실행 중)에는 발동 불가

### 4.2 리액션 카드 (Reaction)

**정의**: 특정 조건 충족 시 자동으로 발동되는 반응형 카드

| 항목 | 설명 |
|------|------|
| **배치** | 핸드에서 캐릭터의 카드 슬롯에 배치 |
| **발동 조건** | 카드별 고유 조건 (조건 충족 시 **확정 발동**) |
| **효과 처리** | 발동은 확정, 효과 내 확률 존재 가능 |

**리액션 카드 예시**:

| 카드명 | 출처 | 발동 조건 | 효과 |
|--------|------|-----------|------|
| 회피 | 도적 캐릭터 | 피격 시 | 30% 확률로 공격 회피 |
| 최후의 공격 | 전사 캐릭터 | 공격 시 + HP 20% 이하 | 추가 데미지 |
| 암살자의 기습 | 암살자 캐릭터 | 공격 시 + 후방열 위치 | 치명타 확률 증가 |

**핵심**: 도적의 "회피" 카드를 전사가 사용해도 됨. 효율은 다를 수 있음.

**다중 리액션 처리**:
- 단일 리액션: 즉시 발동
- 2개 이상 트리거: Queue 위젯으로 발동 순서 선택

### 4.3 인챈트 카드 (Enchant)

**정의**: 지속 효과를 부여하는 버프/디버프 카드

| 항목 | 설명 |
|------|------|
| **배치** | 핸드에서 캐릭터의 카드 슬롯에 배치 |
| **효과 적용** | 배치 즉시 지속 효과 적용 |
| **유지** | 제거하기 전까지 효과 유지 |
| **제거 방식** | **비용 소모 제거** (무거운 책임) |

**인챈트 비용 규칙**:

```
[배치 시]
AP 소모: 카드 코스트 전액 (예: 2 AP)

[제거 시]
AP 소모: 카드 코스트 전액 (예: 2 AP)

총 비용: 배치 2 AP + 제거 2 AP = 4 AP
```

**설계 의도**:
- 인챈트 배치/제거는 **매우 무거운 결정**
- 신중하게 배치해야 함
- 잘못된 인챈트는 비용을 지불하고 제거해야 함
- 인챈트 효과는 이 비용에 걸맞게 강력해야 함

---

## 5. 코스트 시스템 (AP)

### 5.1 캐릭터별 개인 AP

| 항목 | 설명 |
|------|------|
| **단위** | AP (Action Point) |
| **소유** | 캐릭터별 개인 보유 |
| **용도** | 카드 배치, 인챈트 제거 |

```
전사 A: ████░░░░ (4/8 AP)  <- A 슬롯에 배치할 때 A의 AP 소모
힐러 B: ██░░░░░░ (2/8 AP)  <- B 슬롯에 배치할 때 B의 AP 소모
```

### 5.2 AP 회복

| 회복 방법 | 설명 |
|-----------|------|
| 카드 효과 | AP 회복 효과가 있는 카드 사용 |
| 인텐트 | AP 회복 인텐트 실행 |
| 스킬/특성 | 캐릭터 고유 능력 |
| 아이템/유물 | 장비 효과 |

---

## 6. 카드 슬롯

### 6.1 슬롯 개수

| 시점 | 슬롯 수 |
|------|--------|
| **초기** | 모든 캐릭터 1칸 |
| **성장 후** | 캐릭터별 상이 (1~4칸, 최대 5칸) |

**슬롯 확장 요소**:
- 캐릭터 레벨업
- 스토리 진행
- 아이템/유물 획득

### 6.2 슬롯 사용

- 하나의 슬롯에 하나의 카드만 배치 가능
- 액션/리액션/인챈트 어떤 타입이든 배치 가능
- 슬롯이 비어있어도 전투 진행 가능
- **핵심**: 어떤 카드든 어떤 캐릭터 슬롯에든 배치 가능

---

## 7. 카드 획득

### 7.1 획득 경로

| 경로 | 설명 |
|------|------|
| **캐릭터 네러티브** | 캐릭터 고유 스토리에서 유래하는 카드 (주요 경로) |
| **보스 드롭** | 보스 처치 시 해당 보스 카드풀에서 랜덤 1장 |
| **일반/네임드 몹 드롭** | 특정 몹 처치 시 확률적 드롭 |
| **상점** | 골드로 구매 |
| **스토리 보상** | 스토리 진행에 따른 보상 |

### 7.2 캐릭터 네러티브 카드

**핵심 개념**: 각 캐릭터는 자신의 스토리와 특성을 반영한 카드를 보유

| 캐릭터 컨셉 | 카드 예시 | 설명 |
|-------------|-----------|------|
| **도적** (빈민가 출신) | 회피, 기습, 도주 | 생존과 기습에 특화 |
| **전사** (기사단 출신) | 돌격, 수호, 최후의 일격 | 정면 전투와 보호 |
| **마법사** (학원 출신) | 화염구, 마나 폭발, 집중 | 광역 딜과 버프 |

**중요**: 도적 카드를 마법사가 사용해도 됨. 효율은 다를 수 있음.

---

## 8. 카드 설계 프레임워크

### 8.1 설계 철학

**핵심 원칙**: 모든 카드에 단일 규칙을 강제하지 않음

| 원칙 | 설명 |
|------|------|
| **개별 메커니즘** | 각 카드는 자신만의 사용 규칙을 가질 수 있음 |
| **복잡도 스펙트럼** | 단순한 카드부터 복잡한 카드까지 공존 |
| **의도적 배타성** | 일부 카드는 특정 캐릭터 전용으로 설계 가능 |
| **선택적 연동** | 위치, 상태, 콤보 등은 카드별로 선택 적용 |

**프레임워크의 역할**: 규칙이 아닌 **도구 모음** 제공

---

### 8.2 설계 도구 (Building Blocks)

카드 설계 시 선택적으로 조합하는 구성 요소

#### 8.2.1 Cost 메커니즘

| 유형 | 설명 | 예시 |
|------|------|------|
| **고정 Cost** | 누가 사용해도 동일 | Cost 2 (고정) |
| **동적 Cost** | 스탯에 따라 변동 | 기본 3 - floor(지력/40) |
| **조건부 Cost** | 상황에 따라 변동 | 후방열: Cost -1 |

**동적 Cost 예시**:
```
[텔레포트]
기본 Cost: 3
Cost 감소: -floor(지력 / 40)
최소 Cost: 1

마법사 (지력 80): 3 - 2 = Cost 1
도적 (지력 40): 3 - 1 = Cost 2
전사 (지력 20): 3 - 0 = Cost 3
```

#### 8.2.2 효과 메커니즘

| 유형 | 설명 | 예시 |
|------|------|------|
| **고정 효과** | 누가 써도 동일 결과 | 30 데미지 |
| **스케일링 효과** | 스탯에 비례 | 20 + (힘 × 0.3) |
| **분기 효과** | 조건에 따라 다른 효과 | 위치별 효과 변화 |
| **변환 효과** | 사용자에 따라 효과 전환 | 힐러: 회복 / 비힐러: 상태이상 해제 |

#### 8.2.3 사용 조건

| 유형 | 설명 | 예시 |
|------|------|------|
| **범용** | 제한 없음 | 기본 공격 |
| **캐릭터 제한** | 특정 캐릭터만 | 도적 전용: 암살 |
| **클래스 제한** | 특정 클래스만 | 마법사 계열 전용 |
| **태그 제한** | 특정 태그 보유 시 | #Stealth 태그 필요 |
| **스탯 제한** | 최소 스탯 요구 | 민첩 50 이상 |
| **위치 제한** | 특정 위치에서만 | 후방열 전용 |
| **상태 제한** | 특정 상태에서만 | HP 30% 이하일 때 |

#### 8.2.4 보너스 조건 (선택적)

| 유형 | 설명 | 예시 |
|------|------|------|
| **위치 보너스** | 그리드 위치에 따른 추가 효과 | 전방열: 데미지 +20% |
| **상태 보너스** | 대상 상태에 따른 추가 효과 | 적 화상 시: 연소 데미지 |
| **콤보 보너스** | 이전 카드와 연계 | 화염 후 사용 시 폭발 추가 |
| **태그 시너지** | 캐릭터-카드 태그 매칭 | 공유 태그 1개당 효과 +5% |

---

### 8.3 복잡도 등급 (Tier)

카드 복잡도를 5단계로 분류

| Tier | 복잡도 | 사용 블록 | 비율 (권장) |
|------|--------|-----------|-------------|
| 1 | 단순 | 고정 Cost + 고정 효과 | 40% |
| 2 | 조건부 | + 사용 조건 1개 | 25% |
| 3 | 스케일링 | + 스케일링 또는 동적 Cost | 20% |
| 4 | 전용 | + 캐릭터/클래스 제한 | 10% |
| 5 | 복합 | 다중 조건 + 다중 효과 | 5% |

**설계 의도**: 대부분 카드는 빠른 판단이 가능한 Tier 1~2

---

### 8.4 예시 카드

#### Tier 1: 단순 카드

```
[기본 공격]
Cost: 1 (고정)
효과: 30 데미지 (고정)
조건: 없음
보너스: 없음

→ 누가 써도 동일. 빠른 판단용.
```

```
[전진]
Cost: 1 (고정)
효과: 1열 전방 이동
조건: 없음
보너스: 없음

→ 반그리드 기본 이동 카드.
```

#### Tier 2: 조건부 카드

```
[기습]
Cost: 2 (고정)
효과: 50 데미지
조건: 후방열에서만 사용 가능
보너스: 없음

→ 위치 제한으로 전략적 가치 부여.
```

```
[최후의 발악]
Cost: 1 (고정)
효과: 80 데미지
조건: 본인 HP 20% 이하일 때만 사용 가능
보너스: 없음

→ 상태 제한으로 리스크-리워드 설계.
```

#### Tier 3: 스케일링 카드

```
[강타]
Cost: 2 (고정)
효과: 20 + (힘 × 0.5) 데미지
조건: 없음
보너스: 없음

→ 힘 스탯 캐릭터가 더 효율적이나, 누구나 사용 가능.
```

```
[텔레포트]
Cost: 3 - floor(지력/40), 최소 1
효과: 아군 유닛 위치 즉시 교환
조건: 없음
보너스: 없음

→ 마법사가 저렴하게 사용, 전사도 Cost 3으로 사용 가능.
```

#### Tier 4: 전용 카드

```
[도적의 암살]
Cost: 3 (고정)
효과: 대상 HP 20% 즉사 판정
조건: 도적 캐릭터 전용
보너스: 은신 상태면 즉사 확률 +30%

→ 의도적으로 도적만 사용 가능하게 설계.
   강력한 효과에 캐릭터 제한으로 밸런스.
```

```
[성기사의 심판]
Cost: 4 (고정)
효과: 100 신성 데미지 + 아군 전체 HP 20 회복
조건: 팔라딘 전용 + 전방열
보너스: 없음

→ 클래스 제한 + 위치 제한 조합.
```

#### Tier 5: 복합 카드

```
[화염 폭발]
Cost: 2 (고정)
효과 (분기):
  - 기본: 25 데미지
  - 전방열 위치: +15 데미지 (근접 폭발)
  - 후방열 위치: 광역(행 전체)으로 전환
  - 대상 화상 상태: +10 데미지 (연소)
조건: 없음
보너스: 마법력 60 이상 시 화상 부여

→ 위치에 따라 효과가 달라짐.
   전사가 전방에서 쓰면 고데미지 단일.
   힐러가 후방에서 쓰면 광역 견제.
```

```
[응급 치료]
Cost: 2 (고정)
효과 (변환):
  - 힐러 사용: HP 회복 40
  - 비힐러 사용: HP 회복 15 + 출혈/독 해제
조건: 없음
보너스: 없음

→ 힐러가 더 효율적이나, 비힐러도 상태이상 해제 용도로 가치 있음.
```

---

### 8.5 설계 가이드라인

| 원칙 | 설명 |
|------|------|
| **의도 우선** | 카드가 전달할 경험/판타지를 먼저 정의 |
| **최소 복잡도** | 의도 달성에 필요한 최소한의 블록만 사용 |
| **명시적 선언** | 각 카드의 규칙을 데이터로 명확히 기술 |
| **예외 허용** | 범용이 기본이지만, 전용 카드도 의도적 설계 가능 |
| **테스트 검증** | 복합 카드는 반드시 실제 플레이 테스트로 검증 |

**복잡도 분포 권장**:
- Tier 1~2 (단순~조건부): **65%** - 빠른 판단, 안정적 선택
- Tier 3 (스케일링): **20%** - 캐릭터별 효율 차이
- Tier 4~5 (전용~복합): **15%** - 고유 경험, 깊은 전략

---

## 9. 카드와 인텐트 상호작용

### 9.1 턴 진행 흐름

```
[턴 증가 (3초 경과)]
         │
         ▼
┌─────────────────────────────────────┐
│ 1. 버리기 예약 카드 처리             │
│ 2. 카드 드로우 (5장 미만일 때)       │
│ 3. 인텐트 실행 (카드 발동 불가)      │
└─────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────┐
│ 턴 진행 중 (0~3초)                   │
│ • 카드 배치 가능 (핸드 → 슬롯)       │
│ • 액션 카드 발동 가능 (스페이스바)   │
│ • 리액션 자동 트리거                 │
│ • 인챈트 효과 지속                   │
│ • 버리기 예약 가능                   │
└─────────────────────────────────────┘
         │
         ▼
[다음 턴 증가...]
```

### 9.2 설계 의도

- **명확한 타이밍 분리**: 인텐트 실행 중에는 카드 발동 불가
- **버그 방지**: 동시 실행으로 인한 예외 상황 차단
- **전략적 긴장감**: 턴 전환 전 카드 발동 여부 판단

---

## 10. 카드 Queue 위젯

### 10.1 사용 상황

| 상황 | 설명 |
|------|------|
| 다중 액션 발동 | 2개 이상 액션 카드 동시 발동 시 |
| 다중 리액션 트리거 | 2개 이상 리액션 조건 충족 시 |

### 10.2 UI 동작

1. Queue 위젯 표시
2. 발동할 카드들 나열
3. 드래그 또는 클릭으로 순서 지정
4. 확인 시 순서대로 실행

---

## 11. 밸런스 파라미터

| 파라미터 | 기본값 | 조정 범위 | 설명 |
|----------|--------|-----------|------|
| 턴당 드로우 | 1장 | 1~3장 | 매 턴 드로우 장수 |
| 핸드 제한 | 5장 | 4~7장 | 최대 보유 가능 장수 |
| 초기 슬롯 | 1칸 | 1~2칸 | 캐릭터 초기 슬롯 |
| 최대 슬롯 | 4~5칸 | 4~5칸 | 캐릭터 최대 슬롯 (테스트 후 확정) |
| 덱 최대 크기 | 40장 | 30~50장 | 덱 최대 카드 수 |
| 스페이스바 연타 간격 | 0.3초 | 0.2~0.5초 | 더블탭 인식 간격 |

---

## 12. 구현 우선순위

### Phase 1: 핵심 시스템
- [ ] 카드 데이터 구조 (DataAsset)
- [ ] 파티 공유 덱 시스템
- [ ] 핸드 관리 (최대 5장)
- [ ] 카드 슬롯 시스템

### Phase 2: 드로우 시스템
- [ ] 턴별 1장 드로우
- [ ] 버리기 예약 시스템
- [ ] 덱 소진 → 묘지 셔플

### Phase 3: 카드 메커니즘
- [ ] 액션 카드 배치/발동
- [ ] 리액션 카드 트리거
- [ ] 인챈트 카드 지속 효과
- [ ] AP 코스트 시스템

### Phase 4: 확장
- [ ] 카드 Queue 위젯
- [ ] 태그 시너지 시스템
- [ ] 스탯 스케일링

---

## 13. 검토 필요 사항

| 항목 | 현재 상태 | 비고 |
|------|----------|------|
| 턴당 드로우 장수 | 1장 (테스트 후 조정) | 2~3장 가능 |
| 최대 슬롯 | 4~5칸 (테스트 후 확정) | 6칸 이상 불가 |
| 카드 중복 제한 | 미정 | 같은 카드 최대 장수 |
| 카드 강화 시스템 | 미정 | 업그레이드 여부 |
| 카드 희귀도 | 미정 | 등급 시스템 여부 |
| 카드-인텐트 상호작용 | 추후 기획 | 심층 설계 필요 |

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| v2.1 | 2026-01-11 | 섹션 8 재설계: "카드-캐릭터 시너지" → "카드 설계 프레임워크", 도구 모음 접근법, 5단계 복잡도 등급 |
| v2.0 | 2026-01-11 | 대폭 개편: 파티 공유 덱, 턴별 1장 드로우, 버리기 예약, 인챈트 제거 비용 100%, 범용 카드 사용 |
| v1.0 | 2026-01-11 | 초안 작성 |